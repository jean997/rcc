---
title: "Gene Expression Correlation"
author: ""
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Gene Expression Correlation}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

This vignette reproduces simulations in section 3.2. Gene expression data is stored in `chr1_genes` which contains expression data for 100 genes on chromosome 1 and `dna_rep_gnes` which contains expression data for 100 genes involved in dna replication. Both data sets have 60 individuals.

```{r, echo = FALSE, warning=FALSE}
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
library(rcc)
```

The simulations shown in section 3.2 are run with a sample size of 30 for both gene sets. The `cor_sim` function generates data and calculates confidence intervals. Data is returned in the same format as `linreg_sim` and `example_sim`.

For the set of genes on chromosome 1:
Plot correlation for chromosome 1 genes
```{r, fig.show='hold', fig.width=5}
library(reshape2)
library(ggplot2)
P_low <- melt(cor(t(chr1_genes), use="p"))
cp_low <- qplot(x=Var1, y=Var2, data=P_low, fill=value, geom="tile") + 
              scale_fill_gradient2(limits=c(-1, 1)) + 
              theme(axis.text.x=element_blank(), axis.text.y=element_blank(), 
                    axis.title.x=element_blank(), axis.title.y = element_blank())
cp_low
```

```{r, eval=FALSE}
set.seed(19519)
sigma_chr1 <- cov(t(chr1_genes))
chr1_sim_results <- cor_sim(Sigma=sigma_chr1, n=30, n.rep=200)
```


For the set of genes involved in DNA replication:
```{r}
Sigma <- cov(t(dna_rep_genes))
dim(Sigma)
```
Plot correlation for DNA repliacation genes:
```{r, fig.show='hold', fig.width=5}
P_high <- melt(cor(t(dna_rep_genes), use="p"))
cp_high <- qplot(x=Var1, y=Var2, data=P_high, fill=value, geom="tile") + 
              scale_fill_gradient2(limits=c(-1, 1)) + 
              theme(axis.text.x=element_blank(), axis.text.y=element_blank(), 
                    axis.title.x=element_blank(), axis.title.y = element_blank())
cp_high
```


```{r, eval=FALSE}
set.seed(19519)
sigma_dnarep <- cov(t(dna_rep_genes))
dna_rep_sim_results <- cor_sim(Sigma=sigma_dnarep, n=30, n.rep=200)
```
